---
title: "【产品实战】系统角色权限设计"
date: 2018-04-18T22:00:00+08:00
hero: "/images/599.png"
excerpt: 基于RBAC模型
timeToRead: 8
authors:
- lele zhu

---
之前做过几个系统类产品，都有涉及到角色权限的设计，也是花心思比较多的部分，尤其是功能交织、数据逻辑较为复杂的系统，在设计过程中可能会突发思维短路，导致发生因逻辑不自洽的产品BUG。

本次选择近期开始做的OA项目作为例子，至于为什么选择这个：一是因为它是最近才做的记得比较清楚，二是在做这个项目也算是继承了我之前关于系统权限与角色的思考，三是相较于某个系统的权限设计，由于种种现实原因，功能模块相关权限是加了权限表来处理，虽然表面用着还好，但实属粗糙！！🙄

综上，这个项目的权限角色设计更有参考意义\~

### 设计背景

* 中小型企业的OA系统
* 有一个人分管多部门，身兼多职的情况
* 承载员工管理/考勤薪酬/工作考评/知识库等多种功能

  ![](/images/oa-_v1-1.png)

  ### 基本原则
* 不要把简单的问题复杂化
* 权限覆盖全面、尽量灵活
* 基于成熟的技术模型进行设计
* 关注安全性，避免越权行为

### 设计过程

**Step 1：确定需要进行设计的要素：账号、角色、权限**

根据系统的实际情况，决定账号层级设计三层：超级管理员（root）、管理员（admin）、用户（user）。

**超级管理员**为上帝视角的账号，不属于企业内任何一位成员，超级管理员天生拥有管理角色参数、赋予或收回用户管理员身份、开通用户账号的权限。

**管理员**存在的前提，首先他是平台的用户，并被超级管理员赋予了管理员身份，管理员拥有开通用户账号，管理用户角色的权限。

**用户**存在的前提是系统后台有录入该成员的档案，并且是在职的状态，换句话来说数据库如果有这一条数据，他就是平台的潜在用户，需要通过管理员进行开通后才能成为正式的用户，用户如果没有被赋予角色，那么他就是系统的游客，只能进行游客身份能做的操作。

**Step 2：厘清相关要素之间的关系，账号、角色、权限分别约束什么**

除了第一点由账号来约束的部分权限外（主要是系统管理部分），根据页面、功能、数据三个维度进行权限的拆分，主要是要确定什么人能看到什么页面，在页面上能使用什么功能，对数据的增删改的权限是如何。

![](/images/1.png)

可以对功能及其关联的功能进行梳理，并整理成表格，避免在设计过程中，因为功能交织或数据流向不明导致出现BUG，比如薪酬计算与考勤核算、薪酬档案是紧密挂钩的，如果拥有薪酬计算的权限，必然就有读取考勤核算、薪酬档案的数据权限，但如果只负责考勤环节，不参与薪酬计算则不需要拥有薪酬相关的权限。

**Step 3：找其它功能类似或角色权限做得不错的系统，领悟它们的设计奥义**

市面上也有很多成熟的OA系统，他们在这个产品领域的权限角色设计还是做得不错的，值得参考，但通常这种系统大多更考虑普适性，也有给企业留出灵活修改部分，要么不够用，要么设计太复杂，在借鉴的过程中，更多需要企业的实际情况、中长期内是否够用，同时也要考虑开发资源情况，不能因为觉得很好就弄得太复杂，不然后面都是泪。

**Step 4：画出角色权限的ER图，找设计的BUG（可以找其他产品或后端开发帮忙看看）**

![](/images/系统权限关系图.jpg)

_账号、角色、权限采用多对一的关系_

![](/images/3333.png)

**账号与角色功能分离设计的原因：**

不同管理员在实际工作分工中有着明显的差异，为了避免因不小心操作不属于其工作职责的业务导致不必要的问题出现，所以需要对管理员也进行角色的划分。

举个例子：A、B都是系统的管理员，也薪酬环节的参与者，同时也A负责薪酬的核算，有薪酬核算模块的增删改功能，但B只需要看薪酬的最终核算结果然后拿着结果去给大家发工资，他不需要做实际的核算工作，但他需要了解情况，所以他只需要访问的权限，这时候可以通过控制A、B的角色来实现。

**Step 5：汇总建议，认真琢磨，继续优化，并逐步完善设计稿**

在设计过程中，难免会有考虑不够到位或者忽略的细节，这时候可以向其他人阐述设计目标，看看达到这个目标的过程中有没有可能会翻车的地方，综合需求相关方、其他产品、开发的意见后，再次细品是不是真的是这样的、应该怎么改、改的过程中会不会引起其它的问题。

### 其它问题

1. 系统角色权限是否存在越权风险，可以通过攻防测试尝试越权来评判，并在过程中加强。
2. 关于用户不小心进入到无权访问的页面，需要有相关提示，避免以为是个BUG，当然他都进去了肯定就多多少少有点BUG。
3. 还有一些与团队相关的权限也需要提前考虑进设计，但一般可以通过给某类用户加标识如部门负责人、小组长等，并通过这些特征来进行某类特殊功能的约束，如考核评价的流转，以此来保证角色管理模块的简洁性。

### 总结

1. 把权限进行分类，账号类型或者其它约定身份角色（部门负责人等）约定的权限具有一定的稳定性，这类权限关系可以直接写在后台，无需通过前端配置，以此来保障权限角色设置页面的简洁性，同时也能避免设置出错的概率。把经常需要变动的权限可以通过前端展示，尤其多见于有租户的SAAS系统。
2. 权限角色的关系可以的表达，通过较为成熟的技术模型或基于开发熟悉表结构来进行，最清晰的方式是通过绘制页面、操作、角色的表单，可以清晰知道操作在哪发生，谁能触发。
3. 评估并合理设置操作权限的粗粒度，通常情况下对于数据的权限会有查、增、删、改，但在实际的业务逻辑中，“增、删、改”通常是一并存在的，在这种情况最好是遵循业务逻辑的规律，无需为了追求解耦或模块化而做过度的区分。

#### 产品界面原型

#### https://id0fax.axshare.com